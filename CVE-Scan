#!/bin/bash

echo "---------------------"
echo "----VULN-CVE-SCAN----"
echo "---------------------"


#Ask for targets IP
echo Target_IP_Address:

read Target_IP_Address

nmap -A -sV -sT --script vuln -oG $Target_IP_Address.txt --script=http-malware-host $Target_IP_Address | awk "/CVE/{print $4 "" $5}"

cat $Target_IP_Address.txt | grep -v "^#|Status: Up" $Target_IP_Address.txt | cut -d' ' -f2,4- | \
sed -n -e 's/Ignored.*//p'  | \
awk '{print "Host: " $1 " Ports: " NF-1; $1=""; for(i=2; i<=NF; i++) { a=a" "$i; }; split(a,s,","); for(e in s) { split(s[e],v,"/"); printf "%-8s %s/%-7s %s\n" , v[2], v[3], v[1], v[5]}; a="" }'

echo "+++++++++++++++++++++"
echo "+++++++Nikto+++++++++"
echo "+++++++++++++++++++++"

nikto -h $Target_IP_Address -output Target.txt

cat Target.txt
